<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CodeSnap</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background: #f5f5f5;
    }

    .status-bar {
      background-color: #000;
      color: white;
      padding: 5px 15px;
      display: flex;
      justify-content: space-between;
      font-size: 12px;
    }

    .nav-bar {
      background-color: #1a1a1a;
      padding: 10px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
    }

    .search-container {
      margin: 15px;
      background: white;
      padding: 10px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .search-container input {
      border: none;
      outline: none;
      width: 100%;
    }

    .tabs {
      display: flex;
      padding: 0 15px;
      border-bottom: 1px solid #ddd;
    }

    .tab {
      padding: 15px;
      position: relative;
      cursor: pointer;
    }

    .tab.active {
      color: #ff4400;
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 2px;
      background: #ff4400;
    }

    .games-container {
      display: flex;
      overflow-x: auto;
      padding: 15px;
      gap: 15px;
    }

    .game-card {
      min-width: 200px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      text-decoration: none;
      color: black;
    }

    .game-image {
      width: 100%;
      height: 150px;
      border-radius: 10px 10px 0 0;
      object-fit: cover;
    }

    .game-info {
      padding: 10px;
    }

    .leaderboard {
      padding: 15px;
      background: white;
      margin: 15px;
      border-radius: 10px;
    }

    .leaderboard h3 {
      margin-bottom: 10px;
    }

    .podium {
      display: flex;
      justify-content: space-around;
      align-items: flex-end;
      padding: 20px 0;
    }

    .position {
      text-align: center;
    }

    .position img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 50%;
      margin-bottom: 5px;
    }

    .position span {
      display: block;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="status-bar">
    <span>TESCO</span>
    <span>08:15</span>
    <div class="status-icons">
      <span>ðŸ“¶</span>
      <span>ðŸ“±</span>
      <span>ðŸ”‹</span>
    </div>
  </div>

  <div class="nav-bar">
    <span>CodeSnap</span>
    <div>
      <span>+</span>
      <span>28</span>
      <span>â‹®</span>
    </div>
  </div>

  <div class="search-container">
    <img src="https://u.cubeupload.com/UploadMaster/1000003131.png" alt="CodeSnap" width="20" />
    <input type="text" placeholder="Search CodeSnap" />
  </div>

  <div class="tabs">
    <div class="tab active">Trending</div>
    <div class="tab">Following</div>
  </div>

  <div id="games" class="games-container">
    <!-- Projects from API -->
  </div>

  <h2 style="text-align: center; margin: 20px 0;">CodeSnap Daily</h2>

  <div class="leaderboard">
    <h3>Leaderboard</h3>
    <div id="podium" class="podium">
      <!-- Leaderboard from API -->
    </div>
  </div>

  <script>
    async function loadProjects() {
      try {
        const res = await fetch('/api/projects');
        const { projects } = await res.json();

        const gamesContainer = document.getElementById('games');
        gamesContainer.innerHTML = '';

        projects.forEach(project => {
          const card = document.createElement('a');
          card.href = project.link || '#';
          card.className = 'game-card';
          card.innerHTML = `
            <img src="${project.image}" class="game-image" alt="${project.name}" />
            <div class="game-info">
              <h3>${project.name}</h3>
              <p>${project.genre}</p>
            </div>`;
          gamesContainer.appendChild(card);
        });
      } catch (err) {
        console.error('Failed to load projects:', err);
      }
    }

    async function loadLeaderboard() {
      try {
        const res = await fetch('/api/leaderboard');
        const { leaderboard } = await res.json();

        const podium = document.getElementById('podium');
        podium.innerHTML = '';

        leaderboard.forEach(player => {
          const div = document.createElement('div');
          div.className = 'position';
          div.innerHTML = `
            <img src="${player.image}" alt="${player.name}" />
            <span>${player.position}st</span>
            <span>${player.name}</span>`;
          podium.appendChild(div);
        });
      } catch (err) {
        console.error('Failed to load leaderboard:', err);
      }
    }

    // Handle tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelector('.tab.active')?.classList.remove('active');
        tab.classList.add('active');
      });
    });

    // Init on page load
    loadProjects();
    loadLeaderboard();
  </script>
</body>
</html>
